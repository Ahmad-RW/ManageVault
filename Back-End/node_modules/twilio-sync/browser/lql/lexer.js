"use strict";

var _keys = require("babel-runtime/core-js/object/keys");

var _keys2 = _interopRequireDefault(_keys);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

Object.defineProperty(exports, "__esModule", { value: true });
var lexemes = require('./config/lexemes');
var helpers = require('./helpers/lexer');
function strToLexemes(str, spaces) {
    var lexemesArray = [];
    str = helpers.clearSpaces(str, spaces);

    var _loop = function _loop() {
        var escaped = false;
        if (str.charAt(0) === '\\') {
            escaped = true;
            str = str.slice(1);
            if (str.length === 0) {
                throw new Error('Backslash at end of string');
            }
        }
        var ret = (0, _keys2.default)(lexemes).some(function (name) {
            if (escaped && lexemes[name].escaped) {
                return false;
            }
            var regexp = helpers.generateRegexp(lexemes[name]);
            if (regexp.test(str)) {
                str = lexemes[name].lexer(str, lexemesArray, spaces);
                return true;
            }
            return false;
        });
        if (!ret) {
            throw new Error('Unknown character : ' + str.charAt(0));
        }
        str = helpers.clearSpaces(str, spaces);
    };

    while (str.length > 0) {
        _loop();
    }
    return lexemesArray;
}
exports.strToLexemes = strToLexemes;